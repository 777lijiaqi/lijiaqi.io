<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Makefile 学习笔记 | Knowledge Base</title>
    <!-- 引入网站图标 -->
    <link rel="icon" type="image/svg+xml" href="../../static/images/favicon.svg">
    <!-- 引入字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;600&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- 引入图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 代码高亮 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    
    <!-- 引入全局样式 -->
    <link rel="stylesheet" href="../../static/css/style.css">

    <style>
        /* --- 本地覆盖样式 (文章专用) --- */
        body {
            padding-top: 80px; /* 给固定导航栏留位置 */
        }

        /* 复用 archive 头部样式 */
        .article-header {
            background: rgba(11, 17, 32, 0.95);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border);
            padding: 1rem 5%;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .back-btn {
            text-decoration: none;
            color: var(--primary);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
        }

        .back-btn:hover {
            color: #fff;
            text-shadow: 0 0 10px var(--primary);
        }

        /* 布局容器 */
        .layout {
            display: flex;
            max-width: 1400px;
            margin: 40px auto;
            padding: 0 20px;
            gap: 40px;
        }

        /* 文章内容区域 */
        article {
            flex: 1;
            background: rgba(30, 41, 59, 0.6); /* 卡片背景 */
            padding: 40px;
            border-radius: 12px;
            border: 1px solid var(--border);
            backdrop-filter: blur(5px);
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            max-width: 900px;
        }

        /* 侧边目录栏 */
        aside {
            flex: 0 0 250px;
            position: sticky;
            top: 100px;
            height: fit-content;
            display: none;
        }

        @media (min-width: 1100px) {
            aside { display: block; }
        }

        /* --- 文章内部排版 (Markdown Style) --- */
        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #fff;
            border-bottom: 1px solid var(--border);
            padding-bottom: 1rem;
            font-family: 'Orbitron', sans-serif;
        }

        h2 {
            font-size: 1.8rem;
            margin-top: 3rem;
            margin-bottom: 1rem;
            color: var(--primary);
            border-left: 5px solid var(--primary);
            padding-left: 15px;
            font-family: 'Orbitron', sans-serif;
        }

        h3 {
            font-size: 1.4rem;
            margin-top: 2rem;
            margin-bottom: 0.8rem;
            color: #fff;
            font-family: 'Fira Code', monospace;
        }

        p, li {
            color: var(--text-main);
            margin-bottom: 1rem;
            font-family: 'Segoe UI', sans-serif;
        }

        code {
            font-family: 'Fira Code', monospace;
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
            padding: 2px 6px;
            border-radius: 4px;
        }

        pre {
            background: #0d1117 !important;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            padding: 12px 15px;
            border: 1px solid var(--border);
            text-align: left;
        }
        th {
            background-color: rgba(14, 165, 233, 0.1);
            color: var(--primary);
            font-family: 'Fira Code', monospace;
        }

        blockquote {
            border-left: 4px solid var(--accent);
            background: rgba(16, 185, 129, 0.05);
            padding: 1rem;
            margin: 1.5rem 0;
            color: #d1d5db;
        }

        /* 目录样式 */
        .toc-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--primary);
            border-bottom: 1px solid var(--border);
            padding-bottom: 5px;
        }
        .toc-list { list-style: none; }
        .toc-list li { margin-bottom: 10px; }
        .toc-list a {
            color: var(--text-muted);
            font-size: 0.9rem;
            transition: 0.2s;
            display: block;
            border-left: 2px solid transparent;
            padding-left: 10px;
            text-decoration: none;
        }
        .toc-list a:hover, .toc-list a.active {
            color: var(--accent);
            border-left-color: var(--accent);
        }
    </style>
</head>
<body>

    <!-- 动态背景容器 -->
    <div class="circuit-bg">
        <div class="line v-line" style="--delay: 0s; --left: 10%;"></div>
        <div class="line v-line" style="--delay: 5s; --left: 90%;"></div>
        <div class="line h-line" style="--delay: 2s; --top: 20%;"></div>
        <div class="line h-line" style="--delay: 7s; --top: 80%;"></div>
    </div>

    <!-- 顶部导航 -->
    <header class="article-header">
        <!-- 返回按钮：ID 用于 JS 动态修改链接 -->
        <a id="back-btn" href="../../archive/archive.html?cat=all" class="back-btn">
            <i class="fas fa-chevron-left"></i> <span>Back to Archive</span>
        </a>
        <div style="font-family: 'Fira Code'; color: var(--text-muted); font-size: 0.9rem;">
            system.read(mode=doc)
        </div>
    </header>

    <div class="layout">
        <!-- 侧边目录 (TOC) -->
        <aside>
            <div class="toc-title">DIRECTORY</div>
            <ul class="toc-list">
                <li><a href="#sec-1">01_Makefile简介</a></li>
                <li><a href="#sec-2">02_编译原理</a></li>
                <li><a href="#sec-3">03_基本规则</a></li>
                <li><a href="#sec-4">04_变量使用</a></li>
                <li><a href="#sec-5">05_常用符号</a></li>
                <li><a href="#sec-6">06_函数详解</a></li>
                <li><a href="#sec-7">07_编译选项</a></li>
            </ul>
        </aside>

        <!-- 文章内容 -->
        <article>
            <h1>Makefile Learn</h1>

            <h2 id="sec-1">一、什么是 Makefile</h2>
            <p>
                <a href="https://www.gnu.org/savannah-checkouts/gnu/make/manual/make.html" target="_blank" style="color:var(--primary)">
                    <i class="fas fa-book"></i> Makefile 官方手册
                </a>
            </p>

            <h2 id="sec-2">二、编译过程 & 原理</h2>
            <blockquote>
                hello.c -> 预处理(cpp) -> hello.i -> 编译器(ccl) -> hello.s -> 汇编器(as) -> hello.o -> 链接器(ld) -> hello可执行二进制目标程序
            </blockquote>

            <table>
                <thead>
                    <tr>
                        <th>文件后缀</th>
                        <th>后缀含义</th>
                        <th>文件后缀</th>
                        <th>后缀含义</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>.a</td><td>静态库文件</td>
                        <td>.c</td><td>C语言源程序文件</td>
                    </tr>
                    <tr>
                        <td>.h</td><td>C语言头文件</td>
                        <td>.i</td><td>预处理文件</td>
                    </tr>
                    <tr>
                        <td>.o</td><td>目标文件</td>
                        <td>.s</td><td>汇编文件</td>
                    </tr>
                    <tr>
                        <td>.so</td><td>动态库文件</td>
                        <td></td><td></td>
                    </tr>
                </tbody>
            </table>

            <!-- (此处省略了部分中间内容，保留原文档的结构，只展示关键样式修改) -->
            
            <h3>1. 预处理指令</h3>
            <pre><code class="language-bash">gcc -E [C源文件]           # 不输出任何预处理文件
gcc -E [C源文件] -o [输出的预处理文件]  # 输出指定名称的预处理文件</code></pre>

            <h2 id="sec-3">三、Makefile 基本格式</h2>
            <pre><code class="language-makefile">targets : prerequisties
    command</code></pre>
            <p>注意：<code>command</code> 前必须使用 <strong>Tab</strong> 键缩进。</p>

            <!-- ...保留您的所有文章内容... -->
            
            <h2 id="sec-7">七、Makefile 编译选项</h2>
            <ul>
                <li><code>-m64</code>: 指定 64 位</li>
                <li><code>-g</code>: 包含调试信息</li>
                <li><code>-O3</code>: 高级优化</li>
                <li><code>-I</code>: 头文件路径</li>
                <li><code>-fpic</code>: 地址无关代码 (用于动态库)</li>
            </ul>

        </article>
    </div>

    <!-- 引入 Prism.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-makefile.min.js"></script>
    
    <!-- 核心逻辑：处理返回链接 & 目录高亮 -->
    <script>
        // 1. 处理返回按钮逻辑
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            // 获取 ?from=... 参数
            // decodeURIComponent 用于把 c%2Fcpp 变回 c/cpp (虽然浏览器通常会自动处理，但为了保险)
            const fromCat = urlParams.get('from'); 
            
            const backBtn = document.getElementById('back-btn');
            
            if (fromCat) {
                // 如果有 from 参数，就用它
                // 注意：这里再次 encodeURIComponent 是为了把它安全地放回 URL 里
                backBtn.href = `../../archive/archive.html?cat=${encodeURIComponent(fromCat)}`;
                console.log("检测到来源，返回链接已设定为:", backBtn.href);
            } else {
                // 如果没有 from 参数（比如直接打开网址），默认回 ALL
                backBtn.href = `../../archive/archive.html?cat=all`;
            }
        });

        // 2. 目录滚动监听 (保持不变)
        const sections = document.querySelectorAll('h2');
        const navLinks = document.querySelectorAll('.toc-list a');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(a => {
                a.classList.remove('active');
                if (a.getAttribute('href').includes(current)) {
                    a.classList.add('active');
                }
            });
        });
    </script>

    <!-- 音乐播放器悬浮窗 (代码保持不变) -->
    <div class="music-player-widget">
        <div class="player-controls">
            <button id="prev-btn" title="Previous"><i class="fas fa-step-backward"></i></button>
            <button id="play-btn" title="Play/Pause"><i class="fas fa-play"></i></button>
            <button id="next-btn" title="Next"><i class="fas fa-step-forward"></i></button>
            <button id="mute-btn" title="Mute"><i class="fas fa-volume-up"></i></button>
        </div>
        <div class="song-info">
            <span id="song-title">Loading...</span>
        </div>
        <audio id="bg-music"></audio>
    </div>

    <!-- 定义根路径变量 (根目录写 ./) -->
    <script>const ROOT_PATH = '../../';</script>
    
    <!-- 引入新的音乐脚本 -->
    <script src="static/js/music.js"></script>

</body>
</html>
