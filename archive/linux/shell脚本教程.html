<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shell 脚本编程与常用命令指南 | 知识文档</title>
    <!-- 引入网站图标 -->
    <link rel="icon" type="image/svg+xml" href="../../static/images/favicon.svg">
    <!-- 引入字体 -->
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;600&family=Orbitron:wght@400;700;900&display=swap"
        rel="stylesheet">
    <!-- 引入图标 -->
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 代码高亮 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />

    <!-- 引入全局样式 -->
    <link rel="stylesheet" href="../../static/css/style.css">

    <style>
        /* --- 本地覆盖样式 (文章专用) --- */
        body {
            padding-top: 80px;
        }

        .article-header {
            background: rgba(11, 17, 32, 0.95);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border);
            padding: 1rem 5%;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .back-btn {
            text-decoration: none;
            color: var(--primary);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
        }

        .back-btn:hover {
            color: #fff;
            text-shadow: 0 0 10px var(--primary);
        }

        .layout {
            display: flex;
            max-width: 1400px;
            margin: 40px auto;
            padding: 0 20px;
            gap: 40px;
        }

        article {
            flex: 1;
            background: rgba(30, 41, 59, 0.6);
            padding: 40px;
            border-radius: 12px;
            border: 1px solid var(--border);
            backdrop-filter: blur(5px);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            max-width: 900px;
        }

        aside {
            flex: 0 0 250px;
            position: sticky;
            top: 100px;
            height: fit-content;
            display: none;
        }

        @media (min-width: 1100px) {
            aside {
                display: block;
            }
        }

        h1 {
            text-align: center;
            font-size: 2.2rem;
            margin-bottom: 2rem;
            color: #fff;
            border-bottom: 1px solid var(--border);
            padding-bottom: 1rem;
            font-family: 'Orbitron', sans-serif;
            line-height: 1.4;
        }

        h2 {
            font-size: 1.6rem;
            margin-top: 3rem;
            margin-bottom: 1rem;
            color: var(--primary);
            border-left: 5px solid var(--primary);
            padding-left: 15px;
            font-family: 'Orbitron', sans-serif;
        }

        h3 {
            font-size: 1.3rem;
            margin-top: 2rem;
            margin-bottom: 0.8rem;
            color: #fff;
            font-family: 'Fira Code', monospace;
        }

        h4 {
            font-size: 1.1rem;
            margin-top: 1.5rem;
            color: var(--accent);
            font-family: 'Fira Code', monospace;
        }

        p,
        li {
            color: var(--text-main);
            margin-bottom: 1rem;
            font-family: 'Segoe UI', sans-serif;
            line-height: 1.8;
        }

        ul,
        ol {
            padding-left: 2rem;
            margin-bottom: 1rem;
        }

        code {
            font-family: 'Fira Code', monospace;
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
            padding: 2px 6px;
            border-radius: 4px;
        }

        pre {
            background: #0d1117 !important;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        blockquote {
            border-left: 4px solid var(--accent);
            background: rgba(16, 185, 129, 0.05);
            padding: 1rem;
            margin: 1.5rem 0;
            color: #d1d5db;
        }

        blockquote p {
            margin: 0;
        }

        .author-quote p {
            text-align: right;
            font-style: italic;
        }

        hr {
            border: 0;
            border-top: 1px solid var(--border);
            margin: 3rem 0;
        }

        .toc-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--primary);
            border-bottom: 1px solid var(--border);
            padding-bottom: 5px;
        }

        .toc-list {
            list-style: none;
            padding-left: 0;
        }

        .toc-list li {
            margin-bottom: 10px;
        }

        .toc-list a {
            color: var(--text-muted);
            font-size: 0.9rem;
            transition: 0.2s;
            display: block;
            border-left: 2px solid transparent;
            padding-left: 10px;
            text-decoration: none;
        }

        .toc-list a:hover,
        .toc-list a.active {
            color: var(--accent);
            border-left-color: var(--accent);
        }

        strong {
            color: var(--primary);
        }

        /* 文章内链接样式 */
        article a {
            color: var(--primary);
            text-decoration: none;
            border-bottom: 1px dashed var(--primary);
            transition: all 0.3s ease;
            position: relative;
            padding: 0 2px;
        }

        article a:hover {
            color: var(--accent);
            border-bottom-color: var(--accent);
            background: rgba(16, 185, 129, 0.1);
            border-radius: 4px;
            text-shadow: 0 0 5px var(--accent);
        }

        /* 官方文档链接特别样式 */
        .official-link-box {
            background: rgba(14, 165, 233, 0.1);
            border: 1px solid var(--primary);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .official-link-box i {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .official-link-box a {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* 命令详解表格 */
        .cmd-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: rgba(0, 0, 0, 0.2);
        }

        .cmd-table th,
        .cmd-table td {
            border: 1px solid var(--border);
            padding: 10px;
            text-align: left;
        }

        .cmd-table th {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
            font-family: 'Orbitron', sans-serif;
        }

        .cmd-table td code {
            background: transparent;
            color: #fff;
            padding: 0;
        }

        /* 折叠面板样式 */
        details {
            background: rgba(30, 41, 59, 0.4);
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 1rem;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        details[open] {
            background: rgba(30, 41, 59, 0.8);
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(14, 165, 233, 0.1);
        }

        summary {
            padding: 1rem;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            color: var(--primary);
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: space-between;
            list-style: none;
        }

        summary::-webkit-details-marker {
            display: none;
        }

        summary::after {
            content: '\f078';
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            transition: transform 0.3s;
        }

        details[open] summary::after {
            transform: rotate(180deg);
        }

        details[open] summary {
            border-bottom: 1px solid var(--border);
        }

        .cmd-content {
            padding: 1rem;
        }

        .cmd-desc {
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
    </style>
</head>

<body>

    <!-- 动态背景容器 -->
    <div class="circuit-bg">
        <div class="line v-line" style="--delay: 0s; --left: 10%;"></div>
        <div class="line v-line" style="--delay: 5s; --left: 90%;"></div>
        <div class="line h-line" style="--delay: 2s; --top: 20%;"></div>
        <div class="line h-line" style="--delay: 7s; --top: 80%;"></div>
    </div>

    <!-- 顶部导航 -->
    <header class="article-header">
        <a id="back-btn" href="../../archive/archive.html?cat=all" class="back-btn">
            <i class="fas fa-chevron-left"></i> <span>Back to Archive</span>
        </a>
        <div style="font-family: 'Fira Code'; color: var(--text-muted); font-size: 0.9rem;">
            system.read(mode=doc_shell)
        </div>
    </header>

    <div class="layout">
        <!-- 侧边目录 -->
        <aside>
            <div class="toc-title">DIRECTORY</div>
            <ul class="toc-list">
                <li><a href="#sec-0">官方文档</a></li>
                <li><a href="#sec-1">一、Shell 脚本基础</a></li>
                <li><a href="#sec-2">二、变量与环境变量</a></li>
                <li><a href="#sec-3">三、流程控制</a></li>
                <li><a href="#sec-4">四、函数</a></li>
                <li><a href="#sec-5">五、常用命令详解 (必查)</a></li>
                <li><a href="#sec-6">六、实战案例</a></li>
            </ul>
        </aside>

        <!-- 文章内容 -->
        <article>
            <h1>Shell 脚本编程与常用命令指南</h1>

            <div id="sec-0" class="official-link-box">
                <i class="fas fa-book-open"></i>
                <div>
                    <p style="margin:0; font-size:0.9rem; color:var(--text-muted);">本文参考自 GNU Bash 官方文档，建议配合阅读：</p>
                    <a href="https://www.gnu.org/software/bash/manual/bash.html" target="_blank">GNU Bash Reference
                        Manual <i class="fas fa-external-link-alt" style="font-size:0.8rem;"></i></a>
                </div>
            </div>

            <p>Shell 脚本是 Linux 系统管理员和开发者的瑞士军刀。它将常用的 Linux 命令组合在一起，实现自动化任务，极大地提高工作效率。</p>

            <hr>

            <h2 id="sec-1">一、Shell 脚本基础</h2>

            <h3>1. Shebang</h3>
            <p>脚本的第一行必须指定解释器，这被称为 Shebang：</p>
            <pre><code class="language-bash">#!/bin/bash
# 上面这行告诉系统用 /bin/bash 来执行这个文件</code></pre>

            <h3>2. 执行权限</h3>
            <p>写好的脚本通常没有执行权限，需要手动添加：</p>
            <pre><code class="language-bash">chmod +x script.sh</code></pre>

            <h3>3. 运行方式与区别</h3>
            <p>Shell 脚本有多种运行方式，它们之间有细微但重要的区别：</p>

            <h4>(1) 作为可执行程序运行 (推荐)</h4>
            <pre><code class="language-bash">./script.sh</code></pre>
            <ul>
                <li><strong>特点</strong>：需要 <code>x</code> 权限。脚本在<strong>新的子 Shell</strong> 中运行。</li>
                <li><strong>影响</strong>：脚本中定义的变量<strong>不会</strong>污染当前 Shell 环境。脚本执行完毕后，子 Shell 销毁。</li>
            </ul>

            <h4>(2) 指定解释器运行</h4>
            <pre><code class="language-bash">bash script.sh
# 或者
sh script.sh</code></pre>
            <ul>
                <li><strong>特点</strong>：<strong>不需要</strong> <code>x</code> 权限。脚本也在<strong>新的子 Shell</strong> 中运行。</li>
                <li><strong>场景</strong>：临时运行没有权限的脚本，或者调试脚本 (使用 <code>bash -x script.sh</code> 查看执行过程)。</li>
            </ul>

            <h4>(3) 在当前 Shell 中运行 (Source)</h4>
            <pre><code class="language-bash">source script.sh
# 或者简写为
. script.sh</code></pre>
            <ul>
                <li><strong>特点</strong>：脚本在<strong>当前 Shell</strong> 进程中运行，不启动子进程。</li>
                <li><strong>影响</strong>：脚本中修改的环境变量（如 <code>export PATH=...</code>）会<strong>直接影响</strong>当前终端。</li>
                <li><strong>场景</strong>：通常用于加载配置文件（如 <code>source ~/.bashrc</code>）或环境变量。</li>
            </ul>

            <hr>

            <h2 id="sec-2">二、变量与环境变量</h2>

            <h3>1. 定义与使用</h3>
            <pre><code class="language-bash">name="LiJiaQi"   # 定义变量 (等号两边不能有空格！)
echo "Hello, $name"  # 使用变量 (推荐用双引号包裹)
echo "Hello, ${name}" # 更严谨的写法</code></pre>

            <h3>2. 特殊变量</h3>
            <table class="cmd-table">
                <tr>
                    <th>变量</th>
                    <th>含义</th>
                </tr>
                <tr>
                    <td><code>$0</code></td>
                    <td>当前脚本的文件名</td>
                </tr>
                <tr>
                    <td><code>$1</code> ~ <code>$9</code></td>
                    <td>脚本接收的第 1 到第 9 个参数</td>
                </tr>
                <tr>
                    <td><code>$#</code></td>
                    <td>传递给脚本的参数个数</td>
                </tr>
                <tr>
                    <td><code>$?</code></td>
                    <td>上一个命令的退出状态 (0 表示成功，非 0 表示失败)</td>
                </tr>
            </table>

            <hr>

            <h2 id="sec-3">三、流程控制</h2>

            <h3>1. 条件判断 (if)</h3>
            <pre><code class="language-bash">if [ -f "/etc/passwd" ]; then
    echo "文件存在"
else
    echo "文件不存在"
fi
# 注意：[ ] 内部两端必须有空格！</code></pre>

            <h3>2. 循环 (Loop)</h3>
            <pre><code class="language-bash"># 遍历文件
for file in *.txt; do
    echo "Processing $file..."
done

# 计数循环
for ((i=1; i<=5; i++)); do
    echo "Count: $i"
done</code></pre>

            <hr>

            <h2 id="sec-4">四、函数</h2>
            <pre><code class="language-bash">function my_log() {
    local msg=$1  # local 定义局部变量
    echo "[$(date +'%Y-%m-%d %H:%M:%S')] $msg"
}

my_log "Backup started."</code></pre>

            <hr>

            <h2 id="sec-5">五、常用命令详解 (必查)</h2>
            <p>以下是 Shell 脚本中最高频使用的命令，点击标题可查看详细用法。</p>

            <!-- 基础文件操作 -->
            <details>
                <summary>1. ls (列出文件)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：列出目录内容。</p>
                    <pre><code class="language-bash">ls -l       # 详细列表模式 (显示权限、大小、时间)
ls -a       # 显示所有文件 (包括隐藏文件)
ls -lh      # 人类可读的大小 (例如 1K, 234M)
ls -t       # 按修改时间排序</code></pre>
                </div>
            </details>

            <details>
                <summary>2. cd (切换目录)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：更改当前工作目录。</p>
                    <pre><code class="language-bash">cd /var/log # 切换到绝对路径
cd ..       # 返回上一级目录
cd ~        # 回到用户主目录
cd -        # 回到上一次所在的目录 (非常实用)</code></pre>
                </div>
            </details>

            <details>
                <summary>3. mkdir (创建目录)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：创建新目录。</p>
                    <pre><code class="language-bash">mkdir mydir
mkdir -p a/b/c  # 递归创建多级目录 (如果父目录不存在则自动创建)</code></pre>
                </div>
            </details>

            <details>
                <summary>4. touch (创建文件)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：创建空文件或更新文件时间戳。</p>
                    <pre><code class="language-bash">touch newfile.txt      # 创建空文件
touch -t 202501011200 file.txt # 修改文件时间戳</code></pre>
                </div>
            </details>

            <details>
                <summary>5. cp (复制)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：复制文件或目录。</p>
                    <pre><code class="language-bash">cp file.txt backup.txt
cp -r src_dir dest_dir # 递归复制目录
cp -i file.txt dest/   # 覆盖前询问</code></pre>
                </div>
            </details>

            <details>
                <summary>6. mv (移动/重命名)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：移动文件或重命名。</p>
                    <pre><code class="language-bash">mv oldname.txt newname.txt # 重命名
mv file.txt /tmp/          # 移动文件</code></pre>
                </div>
            </details>

            <details>
                <summary>7. rm (删除)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：删除文件或目录。</p>
                    <pre><code class="language-bash">rm file.txt
rm -r dir/    # 递归删除目录
rm -rf dir/   # 强制递归删除 (慎用！)</code></pre>
                </div>
            </details>

            <!-- 进阶命令 -->
            <details>
                <summary>8. grep (文本搜索)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：在文件中搜索包含特定模式的行。</p>
                    <pre><code class="language-bash">grep "error" server.log          # 在 server.log 中查找 "error"
grep -r "main" ./src             # 递归查找 ./src 目录下所有包含 "main" 的文件
grep -v "debug" server.log       # 反向查找：显示**不**包含 "debug" 的行
grep -i "Error" server.log       # 忽略大小写
grep -E "error|warn" server.log  # 使用扩展正则查找 error 或 warn</code></pre>
                </div>
            </details>

            <details>
                <summary>9. awk (文本处理神器)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：按列处理文本数据。</p>
                    <pre><code class="language-bash"># 打印文件的第 1 列和第 3 列 (默认以空格分隔)
awk '{print $1, $3}' data.txt

# 指定分隔符为冒号 (处理 /etc/passwd)
awk -F':' '{print $1}' /etc/passwd

# 统计行数 (类似 wc -l)
awk 'END {print NR}' data.txt</code></pre>
                </div>
            </details>

            <details>
                <summary>10. sed (流编辑器)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：对文本进行替换、删除、插入操作。</p>
                    <pre><code class="language-bash"># 将 input.txt 中的 "apple" 替换为 "orange" 并输出 (不修改原文件)
sed 's/apple/orange/g' input.txt

# 直接修改原文件 (-i)
sed -i 's/apple/orange/g' input.txt

# 删除第 3 行
sed '3d' input.txt</code></pre>
                </div>
            </details>

            <details>
                <summary>11. find (文件查找)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：在目录树中查找文件。</p>
                    <pre><code class="language-bash"># 查找当前目录下所有的 .log 文件
find . -name "*.log"

# 查找 7 天前修改过的文件
find /var/log -mtime +7

# 查找并删除所有 .tmp 文件 (慎用！)
find . -name "*.tmp" -exec rm {} \;</code></pre>
                </div>
            </details>

            <details>
                <summary>12. xargs (参数传递)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：将标准输入转换成命令行参数，常与 find 配合使用。</p>
                    <pre><code class="language-bash"># 查找所有 .log 文件并删除 (比 -exec rm {} \; 更高效)
find . -name "*.log" | xargs rm

# 如果文件名包含空格，使用 -0 配合 find -print0
find . -name "*.log" -print0 | xargs -0 rm</code></pre>
                </div>
            </details>

            <details>
                <summary>13. tar (压缩与解压)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：打包和解压文件，Linux 下最常用的压缩工具。</p>
                    <pre><code class="language-bash"># 打包并压缩 (c: create, z: gzip, f: file)
tar -czf backup.tar.gz ./data

# 解压 (x: extract)
tar -xzf backup.tar.gz -C /tmp  # 解压到 /tmp 目录

# 查看压缩包内容 (t: list)
tar -tf backup.tar.gz</code></pre>
                </div>
            </details>

            <details>
                <summary>14. curl (网络请求)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：在命令行发送 HTTP 请求，常用于测试 API 或下载文件。</p>
                    <pre><code class="language-bash"># 发送 GET 请求
curl https://api.example.com/data

# 发送 POST 请求 (带 JSON 数据)
curl -X POST -H "Content-Type: application/json" -d '{"key":"value"}' https://api.example.com/login

# 下载文件 (-O: 使用远程文件名, -L: 跟随重定向)
curl -OL https://example.com/file.zip</code></pre>
                </div>
            </details>

            <details>
                <summary>15. ps & kill (进程管理)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：查看和终止进程。</p>
                    <pre><code class="language-bash"># 查看所有进程 (aux: 显示所有用户的所有进程)
ps aux | grep "python"

# 终止进程 (kill -9 强制终止)
kill -9 &lt;PID&gt;

# 批量终止名为 "my_app" 的所有进程
pkill "my_app"</code></pre>
                </div>
            </details>

            <details>
                <summary>16. chmod & chown (权限管理)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：修改文件权限和所有者。</p>
                    <pre><code class="language-bash"># 修改权限 (755: 所有者rwx, 组rx, 其他rx)
chmod 755 script.sh
chmod +x script.sh  # 添加执行权限

# 修改所有者 (user:group)
chown root:root /var/www/html
chown -R user:user ./project  # 递归修改</code></pre>
                </div>
            </details>

            <details>
                <summary>17. df & du (磁盘空间)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：查看磁盘和文件占用情况。</p>
                    <pre><code class="language-bash"># 查看磁盘剩余空间 (h: human-readable, 自动显示 G/M)
df -h

# 查看当前目录每个文件的大小
du -sh *

# 查看当前目录总大小
du -sh .</code></pre>
                </div>
            </details>

            <details>
                <summary>18. top & htop (系统监控)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：实时查看 CPU、内存使用情况。</p>
                    <pre><code class="language-bash"># 启动 top (按 q 退出)
top

# htop 是 top 的增强版，界面更友好 (需要单独安装)
# sudo apt install htop
htop</code></pre>
                </div>
            </details>

            <details>
                <summary>19. netstat & ss (网络连接)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：查看网络端口和连接状态。</p>
                    <pre><code class="language-bash"># 查看所有监听的端口 (t: tcp, u: udp, l: listening, n: numeric)
netstat -tuln

# ss 是 netstat 的现代替代品，速度更快
ss -tuln</code></pre>
                </div>
            </details>

            <details>
                <summary>20. scp (远程文件传输)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：基于 SSH 的安全文件拷贝。</p>
                    <pre><code class="language-bash"># 上传文件到服务器
scp local_file.txt user@remote_ip:/path/to/remote/

# 从服务器下载文件
scp user@remote_ip:/path/to/remote/file.txt .

# 传输目录 (-r)
scp -r ./local_dir user@remote_ip:/remote_dir</code></pre>
                </div>
            </details>

            <details>
                <summary>21. lsof (列出打开的文件)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：查看哪些进程打开了哪些文件或端口。</p>
                    <pre><code class="language-bash"># 查看占用 8080 端口的进程
lsof -i :8080

# 查看某个用户打开的文件
lsof -u username

# 查看某个进程打开的文件
lsof -p &lt;PID&gt;</code></pre>
                </div>
            </details>

            <details>
                <summary>22. tail & head (查看文件内容)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：查看文件的开头或结尾，常用于查看日志。</p>
                    <pre><code class="language-bash"># 实时查看日志文件新增内容 (非常常用！)
tail -f server.log

# 查看最后 100 行
tail -n 100 server.log

# 查看前 20 行
head -n 20 server.log</code></pre>
                </div>
            </details>

            <details>
                <summary>23. history (历史命令)</summary>
                <div class="cmd-content">
                    <p class="cmd-desc">用途：查看和搜索执行过的命令。</p>
                    <pre><code class="language-bash"># 显示最近执行的命令
history

# 搜索历史命令 (grep 配合)
history | grep "docker"

# 执行历史记录中第 100 条命令
!100</code></pre>
                </div>
            </details>

            <hr>

            <h2 id="sec-6">六、实战案例：自动备份脚本</h2>
            <pre><code class="language-bash">#!/bin/bash

# 配置
SOURCE_DIR="/var/www/html"
BACKUP_DIR="/backup"
DATE=$(date +%Y%m%d)
BACKUP_FILE="$BACKUP_DIR/backup-$DATE.tar.gz"

# 创建备份目录
mkdir -p $BACKUP_DIR

# 打包
echo "Starting backup..."
tar -czf $BACKUP_FILE $SOURCE_DIR

# 检查结果
if [ $? -eq 0 ]; then
    echo "Backup successful: $BACKUP_FILE"
    # 删除 30 天前的旧备份
    find $BACKUP_DIR -name "backup-*.tar.gz" -mtime +30 -delete
else
    echo "Backup failed!"
    exit 1
fi</code></pre>

            <hr>

            <blockquote class="author-quote">
                <p>Author：李家琦</p>
                <p>Date: 2025/12/03</p>
            </blockquote>

        </article>
    </div>

    <!-- 音乐播放器 -->
    <div class="music-player-widget">
        <div class="player-controls">
            <button id="prev-btn"><i class="fas fa-step-backward"></i></button>
            <button id="play-btn"><i class="fas fa-play"></i></button>
            <button id="next-btn"><i class="fas fa-step-forward"></i></button>
            <button id="mute-btn"><i class="fas fa-volume-up"></i></button>
        </div>
        <div class="song-info"><span id="song-title">Loading...</span></div>
        <audio id="bg-music"></audio>
    </div>

    <script>var ROOT_PATH = '../../';</script>
    <script src="../../static/js/music.js"></script>
    <script src="../../static/js/comment.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const fromCat = urlParams.get('from');
            const backBtn = document.getElementById('back-btn');
            if (fromCat) {
                backBtn.href = `../../archive/archive.html?cat=${encodeURIComponent(fromCat)}`;
            } else {
                backBtn.href = `../../archive/archive.html?cat=linux`;
            }
        });

        const sections = document.querySelectorAll('h2, .official-link-box');
        const navLinks = document.querySelectorAll('.toc-list a');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });
            navLinks.forEach(a => {
                a.classList.remove('active');
                if (a.getAttribute('href').includes(current)) {
                    a.classList.add('active');
                }
            });
        });
    </script>
</body>

</html>
